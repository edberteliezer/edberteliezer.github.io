
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v1.6.1/mapbox-gl.js"></script>
    <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v1.6.1/mapbox-gl.css" rel="stylesheet" />
    <!-- Material Design Lite -->
    <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <!-- Material Design icon font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<style>
    #map {position: absolute; top: 0; right: 0; bottom: 0; left: 0;}
</style>
</head>
<body>
    <style>
    .flybox {
    display: block;
    justify-content: center;
    align-items: center;
    position: relative;
    z-index:  999;
    margin: 0px auto;
    width: 80%;
    height: auto;
    padding: 10px;
    border: none;
    border-radius: 3px;
    background: #fafafa;
    text-align: center;
    opacity: 1;
    }
    
        #fly {opacity: 1;}
        #fly.hidden{opacity: 0}
    div.mdl-textfield + div.mdl-textfield {
        margin-left: 15px;    
        }
    .mdl-textfield {
        max-width: 5%;
        padding: 0;
        }
    .mdl-textfield__label {
        top: 4px
        }
    .mdl-textfield__label:after {
        bottom: 0
        }
    #flyform{margin:auto;}
    #fly {
        opacity: 0;
        transition: opacity 0.45s;
        }

    #fly:hover {
        opacity: 1;
        transition: opacity 0.45s;
        }
    </style>

    <div id="map"></div>
    <br />
    <div class="flybox" id="fly">
        <form id="flyform" action="#" autocomplete="off">

        <!-- Starting Position-->
        <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" type="text"  id="slink">
            <label class="mdl-textfield__label" for="sample2">URL</label>
            <span class="mdl-textfield__error"></span>
        </div>
        <!--p id="scoor" style="display: inline-block; margin-left: 10px;margin-right: 10px;margin-bottom: 0;">Lat, Long</p-->
        <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" type="text"  id="szoom" value="18">
            <label class="mdl-textfield__label" for="sample2">Zoom</label>
            <span class="mdl-textfield__error mdl-color-text--red-A700"></span>
        </div>
        <button class="mdl-button mdl-js-button mdl-button--primary" id="startFly" onclick="startInit()">Set</button>
            
        <i class="material-icons" style="vertical-align: middle;margin-right: 15px;" onclick="window.open('https://www.google.com/maps)">
        arrow_forward</i>
            
        <!-- Ending Position-->
        <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" type="text"  id="elink">
            <label class="mdl-textfield__label" for="sample2">URL</label>
            <span class="mdl-textfield__error"></span>
        </div>
        <!--p id="ecoor" style="display: inline-block; margin-left: 10px;margin-right: 10px;margin-bottom: 0;">Lat, Long</p-->
        <div class="mdl-textfield mdl-js-textfield">
            <input class="mdl-textfield__input" type="text"  id="ezoom" value="18">
            <label class="mdl-textfield__label" for="sample2">Zoom</label>
            <span class="mdl-textfield__error mdl-color-text--red-A700"></span>
        </div>
        <button class="mdl-button mdl-js-button mdl-button--primary" id="startFly" onclick="endInit()">Set</button>

        <button class="mdl-button mdl-js-button mdl-button--raised mdl-button--colored" id="timedFly" onclick="flyInit()">FLY</button>
        </form>
    </div>
    
  <script> 

    var map = new mapboxgl.Map({
        container: 'map', // container id
        style: {
            'version': 8,
            'sources': {
                'raster-tiles': {
                    'type': 'raster',
                    'tiles': [
                        'https://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
                        'https://b.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png',
                        'https://c.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png'
                    ],
                    'tileSize': 256,
                    'attribution':
                    'Map tiles by <a target="_top" rel="noopener" href="http://stamen.com">Stamen Design</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a target="_top" rel="noopener" href="http://openstreetmap.org">OpenStreetMap</a>, under <a target="_top" rel="noopener" href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'
                }
            },
            'layers': [{
                'id': 'simple-tiles',
                'type': 'raster',
                'source': 'raster-tiles',
                'minzoom': 0,
                'maxzoom': 22
            }]
        },
        center: [-74.5, 40], // starting position
        zoom: 2, // starting zoom
        attributionControl: false
    });
     

    function fly (lat, lng, zoom) {
        var flng = lng;
        var flat = lat;
        var fzoom = zoom;
        console.log("Flying to: "+flat+" "+flng+" "+fzoom)
        map.flyTo({
            center: [
                flng,
                flat
            ],
            zoom: fzoom,
            essential: true // this animation is considered essential with respect to prefers-reduced-motion
        });
        
    };
    
    function startInit(){
      var slink = document.getElementById("slink").value;
      var smyRegexp = /.*?@([^,]*,[^,]*),.*/g;
      var smymatch = smyRegexp.exec(slink)
      var slatlng = smymatch[1]
      var sresult = slatlng.split(',');
      var slat = sresult[0];
      var slng = sresult[1];
      var szoom = document.getElementById("szoom").value;
      console.log("Starting Latitude: "+slat);
      console.log("Starting Longitude: "+slng);
      console.log("Starting Zoom: "+szoom);
      //document.getElementById('scoor').textContent = slat +', '+ slng;
      fly(slat,slng,szoom);
    };

    function endInit(){
      var elink = document.getElementById("elink").value;
      var emyRegexp = /.*?@([^,]*,[^,]*),.*/g;
      var emymatch = emyRegexp.exec(elink)
      var elatlng = emymatch[1]
      var eresult = elatlng.split(',');
      var elat = eresult[0];
      var elng = eresult[1];
      var ezoom = document.getElementById("ezoom").value;
      console.log("Ending Latitude: "+elat);
      console.log("Ending Longitude: "+elng);
      console.log("Ending Zoom: "+ezoom);
      //document.getElementById('ecoor').textContent = elat +', '+ elng;
      fly(elat,elng,ezoom);
    };
      
    function flyInit(){
        startInit();
        map.getCanvas().style.cursor = 'none';
        map.once('moveend', function(e){
            setTimeout(function(){
                endInit();
                map.once('moveend', function(e){
                    setTimeout(function(){
                    map.getCanvas().style.cursor = 'default';},2000);
                });
            }, 4000);
        });
        
    };
    
//Data by Â© Open OpenStreetMap contributors under free ODbL license. Basemap by Yohan Boniface & Humanitarian OpenStreetMap Team under CC0 public domain license. Map display by Leaflet, free software library

  </script>
</body>
</html>
